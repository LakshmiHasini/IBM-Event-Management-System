<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find My Tickets - EventTribe</title>
    <link rel="stylesheet" href="./src/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
</head>

<body>
    <header>
        <a href="./index.html" style="text-decoration: none;">
            <h1 id="logo"><span>event</span><span class="bi bi-lightning-charge-fill"
                    style="font-size: 18px"></span><span>tribe</span></h1>
        </a>
        <button class="mobile-menu-toggle" aria-label="Toggle menu">
            <span class="bi bi-list"></span>
        </button>
        <div class="search-bar">
            <div>
                <span class="bi bi-search"></span>
                <input type="text" placeholder="Search Events">
            </div>
            <div>
                <span class="bi bi-geo-alt-fill"></span>
                <span>Bangalore</span>
            </div>
            <div class="bi bi-search"></div>
        </div>
        <nav class="navbar">
            <a href="./index.html"><span>Find Events</span></a>
            <a href="./create-event.html"><span>Create Events</span></a>
            <a href="./help.html"><span>Help Center</span></a>
            <a href="./tickets.html"><span>Find My Tickets</span></a>
            <a href="./login.html"><span>Log In</span></a>
        </nav>
        <nav class="mobile-nav">
            <a href="./index.html"><span>Find Events</span></a>
            <a href="./create-event.html"><span>Create Events</span></a>
            <a href="./help.html"><span>Help Center</span></a>
            <a href="./tickets.html"><span>Find My Tickets</span></a>
            <a href="./login.html"><span>Log In</span></a>
        </nav>
    </header>
    <main>
        <section class="tickets">
            <h2>Find My Tickets</h2>
            <div id="tickets-container">
                <!-- Registered events will be displayed here -->
            </div>
        </section>
    </main>

    <footer class="footer-medium">
        <div class="footer-container">
            <div class="footer-top">
                <div class="footer-col brand-col">
                    <h2><span>event</span><span class="bi bi-lightning-charge-fill"
                            style="font-size: 18px"></span><span>tribe</span></h2>
                    <p>Discover and create amazing events in your city.</p>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook"><span class="bi bi-facebook"></span></a>
                        <a href="#" aria-label="Twitter"><span class="bi bi-twitter-x"></span></a>
                        <a href="#" aria-label="Instagram"><span class="bi bi-instagram"></span></a>
                        <a href="#" aria-label="LinkedIn"><span class="bi bi-linkedin"></span></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h3>Plan Events</h3>
                    <ul class="footer-links">
                        <li><a href="./create-event.html">Create Events</a></li>
                        <li><a href="#">Sell Tickets</a></li>
                        <li><a href="#">Online RSVP</a></li>
                        <li><a href="#">Event Management</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Find Events</h3>
                    <ul class="footer-links">
                        <li><a href="./index.html">Browse Events</a></li>
                        <li><a href="#">Virtual Events</a></li>
                        <li><a href="#">Online Classes</a></li>
                        <li><a href="#">Local Events</a></li>
                    </ul>
                </div>
                <div class="footer-col newsletter-col">
                    <h3>Stay Connected</h3>
                    <p>Subscribe for updates.</p>
                    <form class="simple-newsletter" onsubmit="handleNewsletter(event)">
                        <input type="email" placeholder="Email address" required>
                        <button type="submit"><span class="bi bi-arrow-right"></span></button>
                    </form>
                    <div class="contact-links">
                        <a href="./help.html">Help Center</a>
                        <a href="#">Contact Us</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="copyright">©️ 2026 EventTribe</div>
                <div class="legal-links">
                    <a href="#">Privacy</a>
                    <a href="#">Terms</a>
                    <a href="#">Cookies</a>
                </div>
            </div>
        </div>
    </footer>
    <script src="./src/script.js"></script>
    <script>
        function formatDate(dateString) {
            if (!dateString) return 'Date not available';
            const date = new Date(dateString);
            if (isNaN(date.getTime())) return 'Invalid Date';

            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);

            const dateStr = date.toDateString();
            const todayStr = today.toDateString();
            const tomorrowStr = tomorrow.toDateString();

            if (dateStr === todayStr) {
                return 'Today';
            } else if (dateStr === tomorrowStr) {
                return 'Tomorrow';
            } else {
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            }
        }

        function formatTime(timeString) {
            if (!timeString) return 'Time not available';
            const timeParts = timeString.split(':');
            if (timeParts.length < 2) return timeString;

            const hours = parseInt(timeParts[0]);
            const minutes = timeParts[1];
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            return `${displayHours}:${minutes} ${ampm}`;
        }

        function loadRegisteredEvents() {
            const ticketsContainer = document.getElementById('tickets-container');
            const registeredEvents = JSON.parse(localStorage.getItem('eventTribeRegisteredEvents') || '[]');

            if (registeredEvents.length === 0) {
                ticketsContainer.innerHTML = `
                    <div class="empty-state">
                        <span class="bi bi-ticket-perforated"></span>
                        <h3>No tickets found</h3>
                        <p>You haven't registered for any events yet.</p>
                        <a href="./index.html" class="btn btn-primary" style="max-width: 200px; margin-top: 20px;">Browse Events</a>
                    </div>
                `;
                return;
            }

            ticketsContainer.innerHTML = '<h3 style="margin-bottom: 20px;">Your Registered Events</h3>';

            registeredEvents.forEach(event => {
                const ticketCard = document.createElement('div');
                ticketCard.className = 'ticket-card';

                ticketCard.innerHTML = `
                    <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <h4>${event.name}</h4>
                            <p><span class="bi bi-calendar3"></span> ${formatDate(event.date)}</p>
                            <p><span class="bi bi-clock"></span> ${formatTime(event.time)}</p>
                            <p><span class="bi bi-geo-alt-fill"></span> ${event.location}, ${event.city}</p>
                            <p><span class="bi bi-tag"></span> ${event.category}</p>
                            <p style="margin-top: 10px;"><strong>Price: ${event.price === 0 ? 'Free' : '₹' + event.price}</strong></p>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                            <a href="./event.html?id=${event.id}" class="btn btn-primary" style="max-width: 150px;">View Details</a>
                            <button class="btn btn-secondary" onclick="cancelRegistration(${event.id})" style="max-width: 150px;">Cancel Registration</button>
                        </div>
                    </div>
                `;

                ticketsContainer.appendChild(ticketCard);
            });
        }

        function cancelRegistration(eventId) {
            if (confirm('Are you sure you want to cancel your registration for this event?')) {
                const registeredEvents = JSON.parse(localStorage.getItem('eventTribeRegisteredEvents') || '[]');
                const filteredEvents = registeredEvents.filter(e => e.id !== eventId);
                localStorage.setItem('eventTribeRegisteredEvents', JSON.stringify(filteredEvents));

                // Reload the page to update the display
                loadRegisteredEvents();
            }
        }

        document.addEventListener('DOMContentLoaded', loadRegisteredEvents);
    </script>
</body>

</html>